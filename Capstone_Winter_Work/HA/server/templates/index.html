{% include 'header.html' %}

<div class="wrapper">

	<nav id="sidebar" class="bg-primary">
		<div class="sidebar-header bg-secondary">
			<h3>EPIC</h3>
		</div>
			
		<ul class="list-unstyled component">
			<li>
				<a href="#packageSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
					<i class="fas fa-box"></i>
					Packages
				</a>
				<ul class="collapse list-unstyled" id="packageSubmenu">
					<li>
						<a href="/packages">View Packages</a>
					</li>
					<li>
						<a href="/packages/add">Add Package</a>
					</li>
					<hr>
					<p>Packages</p>
					{% for package in packages %}
					<li>
						{% for name in package %}
						<a href="/packages/{{ name }}">{{ name }}</a>
						{%endfor%}
					</li>
					{% endfor %}
					<hr>
				</ul>
			</li>
			<li>
				<a href="#deviceSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
					<i class="fas fa-laptop"></i>
					Devices
				</a>
				<ul class="collapse list-unstyled" id="deviceSubmenu">
					<li>
						<a href="/devices">View Devices</a>
					</li>
					<hr>
					<p>Connected Devices</p>
					{% if devices %}
						{% for device in devices %}
					<li>
						<a href="/devices/{{ device['internal_id'] }}">{{ device['moz_definition']['name'] }}</a>
					</li>
						{% endfor %}
					{% else %}
					<li>
						<span>No Device Connected</span>
					</li>
					{% endif %}
					<hr>
					<p>Found Devices</p>
					{% if found_devices %}
					<li>
						<!-- TODO -->
					</li>
					{% else %}
					<li>
						<span>No Devices Found</span>
					</li>
					{% endif %}
					<hr>
				</ul>
			</li>
			<li>
				<a href="#macroSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
					<i class="fas fa-tasks"></i>
					Macros
				</a>
				<ul class="collapse list-unstyled" id="macroSubmenu">
					<li>
						<a href="/macros">View Macros</a>
					</li>
					<li>
						<a href="/macros/add">Add Macro</a>
					</li>
					<hr>
					<p>Current Macros</p>
					{% if macros %}
					<li>
						<!-- TODO -->
					</li>
					{% else %}
					<li>
						<span>No Macros Found</span>
					</li>
					{% endif %}
					<hr>
				</ul>
			</li>
		</ul>
	</nav>

	<div class="content dashboard" style="width: 100%">
		<nav class="navbar navbar-expand-lg navbar-light bg-light">
			<div class="container-fluid">

				<button type="button" id="sidebarCollapse" class="btn btn-primary">
					<i class="fas fa-align-left"></i>
					<span>Toggle Sidebar</span>
				</button>
				
				<div class="form-group row">
					<input type="text" class="ml-auto w-50" placeholder="Search..." id="search-bar" />
				</div>
			
			</div><!-- .container-fluid -->
		</nav><!-- .navbar -->

		<div class="container-fluid">
			<div class="masonry">
				<!-- Create Package Cards -->
				{% for package in packages %}
					{% for name in package %}
				<div class="card">
					<div class="card-header bg-success text-light">
						{{ name }}
					</div><!-- .card-header -->
					<div>
						<div class="nav nav-tabs" id="tabs-package-{{ package[name]['package_id'] }}" role="tablist">
							<a class="nav-item nav-link active" id="p-info-tab-{{ package[name]['package_id'] }}" data-toggle="tab" href="#p-info-{{ package[name]['package_id'] }}" role="tab" aria-controls="p-info-{{ package[name]['package_id'] }}" aria-selected="true">Meta</a>
							<a class="nav-item nav-link" id="p-cmd-tab-{{ package[name]['package_id'] }}" data-toggle="tab" href="#p-cmd-{{ package[name]['package_id'] }}" role="tab" aria-controls="p-cmd-{{ package[name]['package_id'] }}" aria-selected="true">Commands</a>
							<a class="nav-item nav-link" id="p-app-tab-{{ package[name]['package_id'] }}" data-toggle="tab" href="#p-app-{{ package[name]['package_id'] }}" role="tab" aria-controls="p-app-{{ package[name]['package_id'] }}" aria-selected="true">Applications</a>
							<a class="nav-item nav-link" id="p-binding-tab-{{ package[name]['package_id'] }}" data-toggle="tab" href="#p-binding-{{ package[name]['package_id'] }}" role="tab" aria-controls="p-binding-{{ package[name]['package_id'] }}" aria-selected="true">Bindings</a>
						</div>
						<div class="tab-content" id="tabContent-package-{{package[name]['package_id'] }}">
							<div class="tab-pane card-body fade show active" id="p-info-{{ package[name]['package_id'] }}" role="tabpanel" aria-labelledby="p-info-tab-{{ package[name]['package_id'] }}">
								<span>Creator: {{ package[name]['meta']['creator'] }}</span><br>
								<span>Last Modified: {{ package[name]['meta']['last modified'] }}</span><br>
								<span>Description: {{ package[name]['meta']['description'] }}</span><br>
							</div>
							<div class="tab-pane card-body fade" id="p-cmd-{{ package[name]['package_id'] }}" role="tabpanel" aria-labelledby="p-cmd-tab-{{ package[name]['package_id'] }}">
								<ul>
								{% for command in package[name]['commands'] %}
									<li>{{ command }}</li>
								{% endfor %}
								</ul>
							</div>
							<div class="tab-pane card-body fade" id="p-app-{{ package[name]['package_id'] }}" role="tabpanel" aria-labelledby="p-app-tab-{{ package[name]['package_id'] }}">
								<ul>
								{% for application in package[name]['applications'] %}
									<li>{{ application }}</li>
								{% endfor %}
								</ul>
							</div>
							<div class="tab-pane card-body fade" id="p-binding-{{ package[name]['package_id'] }}" role="tabpanel" aria-labelledby="p-binding-tab-{{ package[name]['package_id'] }}">
								<ul>
								{% for binding in package[name]['bindings'] %}
									<li>{{ binding }}</li>
								{% endfor %}
								</ul>
							</div>
						</div>
					</div><!-- .card-body -->
				</div><!-- .card -->
					{% endfor %}
				{% endfor %}
				<!-- Create Device Cards -->
				{% for device in devices %}
				<div class="card">
					<div class="card-header bg-warning text-light">
						{{ device['moz_definition']['name']|title }}	
					</div>
					<div>
						<div class="nav nav-tabs" id="tabs-device-{{ device['internal_id'] }}" role="tablist">
							<a class="nav-item nav-link active" id="d-info-tab-{{ device['internal_id'] }}" data-toggle="tab" href="#d-info-{{ device['internal_id'] }}" role="tab" aria-controls="d-info-{{ device['internal_id'] }}" aria-selected="true">Info</a>
							<a class="nav-item nav-link" id="d-property-tab-{{ device['internal_id'] }}" data-toggle="tab" href="#d-property-{{ device['internal_id'] }}" role="tab" aria-controls="d-property-{{ device['internal_id'] }}" aria-selected="true">Properties</a>
							<a class="nav-item nav-link" id="d-action-tab-{{ device['internal_id'] }}" data-toggle="tab" href="#d-action-{{ device['internal_id'] }}" role="tab" aria-controls="d-action-{{ device['internal_id'] }}" aria-selected="true">Actions</a>
						</div><!-- .nav-pills -->
						<div class="tab-content" id="tabContent-device-{{ device['internal_id'] }}">
							<div class="tab-pane card-body fade show active" id="d-info-{{ device['internal_id'] }}" role="tabpanel" aria-labelledby="d-info-tab-{{ device['internal_id'] }}">
								<span>Internal UUID: {{ device['internal_id'] }}</span><br>
								<span>Manager ID: {{ device['manager_id'] }}</span><br>
								<span>Description: {{ device['moz_definition']['description'] }}</span><br>
							</div><!-- #info-tab -->
							<div class="tab-pane card-body fade" id="d-property-{{ device['internal_id'] }}" role="tabpanel" aria-labelledby="d-property-tab--{{ device['internal_id'] }}">
							{% for property in device['moz_definition']['properties'] %}
								<span>{{ property|title }}: {{ device['moz_definition']['properties'][property]['description'] }}</span><br>
								<div class="container-fluid">
									<div class="form-group form-row">
										<input type="text" class="col-7 form-control read-value-display" readonly value="--"/>
										<button type="button" class="col-4 offset-1 btn btn-primary submit-read" data-target="{{ device["internal_id"] }}" data-property="{{ property }}">Read</button>
									</div>
									{% if device['moz_definition']['properties'][property]['readOnly'] == False %}
									<div class="form-group form-row">
										<input type="text" class="col-7 form-control" />
										<button type="button" class="col-4 offset-1 btn btn-primary">Write</button>
									</div>
									{% endif %}
								</div>
							{% endfor %}
							</div><!-- #property-tab -->
							<div class="tab-pane card-body fade" id="d-action-{{ device['internal_id'] }}" role="tabpanel" aria-labelledby="d-action-tab-{{ device['internal_id'] }}">
							{% for action in device['moz_definition']['actions'] %}
								<div class="container-fluid">
									<div class="form-group form-row">
										<input type="text" class="col-7 form-control" readonly value="{{ action }}">
										<button type="button" class="col-4 offset-1 btn btn-primary">Trigger</button>
									</div>
								</div>
							{% endfor %}
							</div>
						</div><!-- .tab-content -->
					</div><!-- .card-body -->
				</div><!-- .card -->
				{% endfor %}
			</div><!-- .masonry -->
		</div><!-- .container-fluid -->

	</div><!-- .dashboard -->

</body>

</html>

